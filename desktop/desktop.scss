/* ===============================================
   Builder Labs â€” unified layout + callouts
   =============================================== */

/* --- Tunables ------------------------------------------------------ */
:where(.category-builder-labs){
  --site-gutter: 24px;              /* adjust until it lines up with your desired black line */
  --toc-gap: 2rem;
  --toc-min: 18rem;
  --toc-max: 22rem;

  --callout-rail: clamp(16px, 1.4vw, 20px);
  --callout-radius: 12px;
  --callout-pad-y: 12px;
  --callout-pad-x: 16px;
  --callout-indent: 26px;
  --callout-icon-size: clamp(28px, 2.2vw, 34px);
  --callout-icon-gap: 20px;
  --callout-left-pad: calc(var(--callout-rail) + 8px);
  --callout-icon-nudge: -1px;

  /* Brand hues */
  --brand-lagoon:      #86B0B6;
  --brand-driftwood:   #887E6F;
  --brand-peach:       #F3B38F;
  --brand-chaparral:   #596D67;
  --brand-karl:        #B4C5CB;
  --brand-periwinkle:  #CDC6E6;
  --brand-beaujolais:  #D893AF;
  --brand-wheatgrass:  #D6C56B;
  --brand-aspen:       #CED8A3;

  /* Semantic mapping */
  --tone-term:    var(--brand-peach);
  --tone-hint:    var(--brand-lagoon);
  --tone-pro:     var(--brand-chaparral);
  --tone-note:    var(--brand-aspen);
  --tone-success: var(--brand-periwinkle);
  --tone-time:    var(--brand-beaujolais);

  --fg-strong: #243041;
  --light-surface: #ffffff;

  --tint-term:    66%;
  --tint-hint:    34%;
  --tint-pro:     18%;
  --tint-note:    36%;
  --tint-success: 70%;
  --tint-time:    58%;
}

/* --- Kill sidebar / rails ------------------------------------------ */
:where(.category-builder-labs, .category-builder-labs :root){ --d-sidebar-width: 0 !important; }
:where(.category-builder-labs) :is(.sidebar-wrapper, .sidebar-container,
  .discourse-sidebar, .d-sidebar, .hamburger-panel){
  display: none !important;
  width: 0 !important;
  min-width: 0 !important;
}

/* --- Header + wrappers honor same gutter --------------------------- */
:where(.category-builder-labs) :is(.d-header .wrap, .d-header .contents,
  .wrap, .d-wrap, #main-outlet-wrap, #main-outlet){
  max-width: none !important;
  width: 100% !important;
  margin: 0 !important;
  padding-left: var(--site-gutter) !important;
  padding-right: var(--site-gutter) !important;
}

/* --- Main outlet grid ---------------------------------------------- */
:where(.category-builder-labs) #main-outlet{
  display: grid !important;
  grid-template-columns: minmax(var(--toc-min), var(--toc-max)) minmax(0, 1fr) !important;
  column-gap: var(--toc-gap) !important;
}

/* TOC left, content right */
:where(.category-builder-labs) .container.posts{ display: contents !important; }
:where(.category-builder-labs) .container.posts .topic-navigation{ grid-column: 1 / 2 !important; }
:where(.category-builder-labs) .container.posts > .row{ grid-column: 2 / 3 !important; }

/* Title row aligns with same gutter */
:where(.category-builder-labs) #topic-title{
  grid-column: 1 / -1 !important;
  display: grid !important;
  grid-template-columns: minmax(var(--toc-min), var(--toc-max)) minmax(0, 1fr) !important;
  column-gap: var(--toc-gap) !important;
  margin: 0 !important;
  padding: 0 !important;
}
:where(.category-builder-labs) #topic-title .title-wrapper{
  grid-column: 1 / -1 !important;  /* left edge = TOC edge */
  margin: 0 !important;
  padding: 0 !important;
}

/* --- TOC cleanup --------------------------------------------------- */
:where(.category-builder-labs) .topic-navigation :is(.d-toc, .d-toc-main){
  border-left: none !important;
  padding-left: 0 !important;
  margin-left: 0 !important;
}
:where(.category-builder-labs) .container.posts .topic-navigation{
  position: sticky; top: 6rem;
  align-self: start;
  font-size: 1.08rem; line-height: 1.5;
  margin: 0 !important;
}

/* --- General blog niceties ---------------------------------------- */
:where(.category-builder-labs) :is(.topic-timeline, .topic-map.--bottom,
  #topic-progress-wrapper.docked, .timeline-container.timeline-docked){ display: none !important; }

:where(.category-builder-labs) .topic-post .topic-body{
  margin-left: 0 !important; padding-left: 0 !important; max-width: 720px;
}
:where(.category-builder-labs) .topic-post:first-child{
  font-size: 1.25em; line-height: 1.4; padding-top: 4px; padding-bottom: 0;
}
:where(.category-builder-labs) .topic-post:first-child .cooked{ padding: 0; }

/* Headings treatment */
:where(.category-builder-labs) .cooked h1{
  margin: 2em 0 1em 0; padding: .75em .5em; background: #000; color: #fff;
}
:where(.category-builder-labs) .cooked h2{
  margin: 2em 0 1em 0; padding: .25em .5em; background: #b2b2b2; color: #000;
}

/* --- Callouts ------------------------------------------------------ */
:where(.category-builder-labs) .cooked blockquote:has(> p:first-child){
  --callout-bg: var(--note-bg);
  --callout-accent: var(--note-rail);
  position: relative;
  background: var(--callout-bg);
  border-left: var(--callout-rail) solid var(--callout-accent);
  border-radius: var(--callout-radius);
  padding: var(--callout-pad-y) var(--callout-pad-x);
  margin: 16px 0 16px var(--callout-indent);
  color: var(--callout-fg, var(--fg-strong));
}

/* --- Dark mode ----------------------------------------------------- */
@media (prefers-color-scheme: dark){
  :where(.category-builder-labs){
    --lab-surface-dark: #0c0f14;
    --fg-strong: #edf2f8;
    --term-bg:     color-mix(in hsl,  var(--tone-term)    54%, var(--lab-surface-dark));
    --hint-bg:     color-mix(in hsl,  var(--tone-hint)    42%, var(--lab-surface-dark));
    --pro-bg:      color-mix(in hsl,  var(--tone-pro)     42%, var(--lab-surface-dark));
    --note-bg:     color-mix(in hsl,  var(--tone-note)    58%, var(--lab-surface-dark));
    --success-bg:  color-mix(in hsl,  var(--tone-success) 64%, var(--lab-surface-dark));
    --time-bg:     color-mix(in hsl,  var(--tone-time)    50%, var(--lab-surface-dark));
  }
  :where(.category-builder-labs) .cooked blockquote{
    color: var(--fg-strong);
    box-shadow: inset 0 1px 0 rgba(255,255,255,.07),
                0 0 0 1px color-mix(in oklch, var(--callout-accent) 18%, transparent);
  }
}
